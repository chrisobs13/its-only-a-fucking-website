<h1>Gift <a href="http://travis-ci.org/notatestuser/gift"><img src="https://secure.travis-ci.org/notatestuser/gift.png?branch=master" alt="Build Status" /></a> <a href="https://david-dm.org/notatestuser/gift"><img src="https://david-dm.org/notatestuser/gift.png" alt="Dependency Status" /></a> <a href="https://david-dm.org/notatestuser/gift#info=devDependencies"><img src="https://david-dm.org/notatestuser/gift/dev-status.png" alt="devDependency Status" /></a></h1>

<p>A simple Node.js wrapper for the Git CLI. The API is based on
<a href="https://github.com/mojombo/grit">Grit</a></p>

<h1>Installation</h1>

<p>This fork is now in the <code>npm</code> package repository. Install it like you would any other package:</p>

<pre><code>$ npm install gift
</code></pre>

<h1>API</h1>

<p>For existing repositories:</p>

<pre><code>git  = require 'gift'

repo = git "path/to/repo"
# =&gt; #&lt;Repo&gt;
</code></pre>

<p>Initialize a new repository:</p>

<pre><code>git = require 'gift'

git.init "path/to/repo", (err, _repo) -&gt;
  repo = _repo
  # =&gt; #&lt;Repo&gt;
</code></pre>

<p>Initialize a new bare repository:</p>

<pre><code>git = require 'gift'

git.init "path/to/bare/repo", true, (err, _repo) -&gt;
  repo = _repo
  # =&gt; #&lt;Repo&gt;
</code></pre>

<p>Clone a repository:</p>

<pre><code>git = require 'gift'

git.clone "git@host:path/to/remote/repo.git", "path/to/local/clone/repo", (err, _repo) -&gt;
  repo = _repo
  # =&gt; #&lt;Repo&gt;
</code></pre>

<h2>Repo</h2>
<p>### <code>Repo#path</code>
<code>String</code> - The path to the repository.</p>

<h3><code>Repo#commits([treeish, [limit, [skip, ]]]callback)</code></h3>
<p>Get a list of commits.</p>

<ul>
  <li><code>treeish</code>  - <code>String</code>  (optional).</li>
  <li><code>limit</code>    - <code>Integer</code> (optional).</li>
  <li><code>skip</code>     - <code>Integer</code> (optional).</li>
  <li><code>callback</code> - <code>Function</code> which receives <code>(err, commits)</code>, where <code>commits</code> is
             an <code>Array</code> of <code>Commit</code>s.</li>
</ul>

<p>Get the 10 most recent commits to master.</p>

<pre><code>repo.commits (err, commits) -&gt;
</code></pre>

<p>Or to a different tag or branch.</p>

<pre><code>repo.commits "v0.0.3", (err, commits) -&gt;
</code></pre>

<p>Limit the maximum number of commits returned (by default limit is 10).</p>

<pre><code>repo.commits "master", 30, (err, commits) -&gt;
</code></pre>

<p>Skip some (for pagination):</p>

<pre><code>repo.commits "master", 30, 30, (err, commits) -&gt;
</code></pre>

<p>Or get an unlimited number of commits (there could be a lot):</p>

<pre><code>repo.commits "master", -1, (err, commits) -&gt;
</code></pre>

<h3><code>Repo#current_commit(callback)</code></h3>
<p>Get the current commit.</p>

<p>The callback receives <code>(err, commit)</code>.</p>

<h3><code>Repo#tree([treeish]) =&gt; Tree</code></h3>
<p>The <code>Tree</code> object for the treeish (which defaults to “master”).</p>

<pre><code>repo.tree().contents (err, children) -&gt;
  for child in children
    console.log child.name
</code></pre>

<h3><code>Repo#diff(commitA, commitB, [paths, ]callback)</code></h3>
<p>Get the difference between the trees.</p>

<p>The callback receives <code>(err, diffs)</code>.</p>

<h3><code>Repo#identity(callback)</code></h3>
<p>Get the commit identity for this repository.</p>

<p>The callback receives <code>(err, actor)</code>, where <code>actor</code> is an Actor.</p>

<h3><code>Repo#identify(actor, callback)</code></h3>
<p>Set your account’s default identity for commits to this repository.</p>

<p>The callback receives <code>(err)</code>.</p>

<h3><code>Repo#remotes(callback)</code></h3>
<p>Get the repository’s remotes.</p>

<p>Receives <code>(err, remotes)</code>, where each remote is a Ref.</p>

<h3><code>Repo#remote_list(callback)</code></h3>
<p>Get a list of the repository’s remote names.</p>

<p>Get the string names of each of the remotes.</p>

<h3><code>Repo#remote_add(name, url, callback)</code></h3>
<p>Equivalent to <code>git remote add &lt;name&gt; &lt;url&gt;</code>.</p>

<h3><code>Repo#remote_remove(name, callback)</code></h3>
<p>Remove a remote.</p>

<h3><code>Repo#remote_fetch(name, callback)</code></h3>
<p><code>git fetch &lt;name&gt;</code></p>

<h3><code>Repo#remote_push(name, [branch, ]callback)</code></h3>
<p><code>git push &lt;name&gt;</code></p>

<p>with branch parameter specified:
<code>git push &lt;name&gt; &lt;branch&gt;</code></p>

<h3><code>Repo#status(callback)</code></h3>
<p>Uses <code>--porcelain</code> to parse repository status in a way that is agnostic of system language. The callback receives <code>(err, status)</code>. See below for a definition of what <code>status</code> is.</p>

<h3><code>Repo#config(callback)</code></h3>
<p><code>git config</code> parsed as a simple, one-level object. The callback receives <code>(err, config)</code>.</p>

<h3><code>Repo#create_branch(name, callback)</code></h3>
<p>Create a new branch with <code>name</code>, and call the callback when complete
with an error, if one occurred.</p>

<h3><code>Repo#delete_branch(name, callback)</code></h3>
<p>Delete the branch <code>name</code>, and call the callback with an error, if one occurred.</p>

<h3><code>Repo#tags(callback)</code></h3>
<p>Get a list of <code>Tag</code>s.</p>

<h3><code>Repo#create_tag(name, [options, ]callback)</code></h3>
<p>Create a tab with the given name.</p>

<h3><code>Repo#delete_tag(name, callback)</code></h3>
<p>Delete the tag with the given name.</p>

<h3><code>Repo#branches(callback)</code></h3>
<p><code>callback</code> receives <code>(err, heads)</code>.</p>

<h3><code>Repo#create_branch(name, callback)</code></h3>
<p>Create a branch with the given name.</p>

<h3><code>Repo#delete_branch(delete, callback)</code></h3>
<p>Delete the branch with the given name.</p>

<h3><code>Repo#branch([branch, ]callback)</code></h3>
<p>Get a branch.</p>

<ul>
  <li><code>branch</code>   - The name of the branch to get. Defaults to the
             currently checked out branch.</li>
  <li><code>callback</code> - Receives <code>(err, head)</code>.</li>
</ul>

<h3><code>Repo#commit(message, [options, ]callback)</code></h3>
<p>Commit some changes.</p>

<ul>
  <li><code>message</code>  - <code>String</code></li>
  <li><code>options</code>  -
    <ul>
      <li><code>all</code>    - <code>Boolean</code></li>
      <li><code>amend</code>  - <code>Boolean</code></li>
      <li><code>author</code> - <code>String</code> that must match “Au thor Author <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#097;&#117;&#116;&#104;&#111;&#114;&#064;&#110;&#111;&#119;&#104;&#101;&#114;&#101;&#046;&#111;&#114;&#103;">&#097;&#117;&#116;&#104;&#111;&#114;&#064;&#110;&#111;&#119;&#104;&#101;&#114;&#101;&#046;&#111;&#114;&#103;</a>”</li>
    </ul>
  </li>
  <li><code>callback</code> - Receives <code>(err)</code>.</li>
</ul>

<h3><code>Repo#add(files, callback)</code></h3>
<p><code>git add &lt;files&gt;</code></p>

<h3><code>Repo#remove(files, callback)</code></h3>
<p><code>git rm &lt;files&gt;</code></p>

<h3><code>Repo#checkout(treeish, callback)</code></h3>
<p><code>git checkout &lt;treeish&gt;</code></p>

<h3><code>Repo#checkoutFile([files, options, ]callback)</code></h3>
<p>Checkout some files.</p>

<ul>
  <li><code>files</code>   - File(s) to checkout. Pass <code>'.'</code> or nothing to checkout all files.</li>
  <li><code>options</code>   -
    <ul>
      <li><code>force</code>   - <code>Boolean</code></li>
    </ul>
  </li>
  <li><code>callback</code>  - Receives <code>(err)</code>.</li>
</ul>

<h3><code>Repo#sync([[remote, ]branch, ]callback)</code></h3>
<p>Sync the current branch with the remote, keeping all local changes intact.</p>

<p>The following steps are carried out: <code>stash</code>, <code>pull</code>, <code>push</code>, <code>stash pop</code>. If there were no changes to stash, the last <code>stash pop</code> is not executed.</p>

<ul>
  <li><code>remote</code>   - <code>String</code> (defaults to <code>origin</code>).</li>
  <li><code>branch</code>   - <code>String</code> (defaults to <code>master</code>).</li>
  <li><code>callback</code> - Receives <code>(err)</code>.</li>
</ul>

<h3><code>Repo#reset([treeish, options, ]callback)</code></h3>
<p>Checkout files.</p>

<ul>
  <li><code>treeish</code>   - The git object to reset to. Defaults to HEAD.</li>
  <li><code>options</code>   -
    <ul>
      <li><code>soft</code>    - <code>Boolean</code></li>
      <li><code>mixed</code>   - <code>Boolean</code> <strong>default</strong></li>
      <li><code>hard</code>    - <code>Boolean</code></li>
      <li><code>merge</code>   - <code>Boolean</code></li>
      <li><code>keep</code>    - <code>Boolean</code></li>
    </ul>
  </li>
  <li><code>callback</code>  - Receives <code>(err)</code>.</li>
</ul>

<h2>Commit</h2>
<p>### <code>Commit#id</code>
<code>String</code> - The commit’s SHA.</p>

<h3><code>Commit#parents</code></h3>
<p><code>Commit[]</code></p>

<h3><code>Commit#tree()</code></h3>
<p><code>Tree</code> - The commit’s content tree.</p>

<h3><code>Commit#author</code></h3>
<p><code>Actor</code>
### <code>Commit#authored_date</code>
<code>Date</code>
### <code>Commit#committer</code>
<code>Actor</code>
### <code>Commit#committed_date</code>
<code>Date</code>
### <code>Commit#message</code>
<code>String</code></p>

<h2>Head</h2>
<p>### <code>Head#name</code>
<code>String</code></p>

<h3><code>Head#commit</code></h3>
<p><code>Commit</code></p>

<h2>Tag</h2>
<p>### <code>Tag#name</code>
<code>String</code></p>

<h3><code>Tag#commit</code></h3>
<p><code>Commit</code></p>

<h3><code>Tag#message(callback)</code></h3>
<p>The callback receives <code>(err, message)</code> (<code>message</code> is a String).</p>

<h3><code>Tag#tagger(callback)</code></h3>
<p>The callback receives <code>(err, actor)</code>.</p>

<h3><code>Tag#tag_date(callback)</code></h3>
<p>The callback receives <code>(err, date)</code>.</p>

<h2>Config</h2>
<p>### <code>Config#items</code>
<code>Object</code> - The keys are dotted precisely as the console output from <code>git config</code>. E.g., <code>{'user.name': 'John Doe'}</code></p>

<h2>Status</h2>
<p>### <code>Status#clean</code>
<code>Boolean</code></p>

<h3><code>Status#files</code></h3>
<p><code>Object</code> - The keys are files, the values objects indicating whether or not
the file is staged, tracked, etc.</p>

<p>Each file has the following properties:</p>

<ul>
  <li><code>type</code> which translates to:</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: left"><em>type</em></th>
      <th style="text-align: center">index</th>
      <th style="text-align: center">working tree</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code>A </code></td>
      <td style="text-align: center">added</td>
      <td style="text-align: center">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>M </code></td>
      <td style="text-align: center">modified</td>
      <td style="text-align: center">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>D </code></td>
      <td style="text-align: center">deleted</td>
      <td style="text-align: center">-</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>AM</code></td>
      <td style="text-align: center">added</td>
      <td style="text-align: center">modified</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>MM</code></td>
      <td style="text-align: center">modified</td>
      <td style="text-align: center">modified</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>AD</code></td>
      <td style="text-align: center">staged</td>
      <td style="text-align: center">deleted</td>
    </tr>
    <tr>
      <td style="text-align: left"><code>MD</code></td>
      <td style="text-align: center">modified</td>
      <td style="text-align: center">deleted</td>
    </tr>
  </tbody>
</table>

<ul>
  <li><code>staged</code>  - <code>Boolean</code></li>
  <li><code>tracked</code> - <code>Boolean</code></li>
</ul>

<h2>Actor</h2>
<p>### <code>Actor#name</code>
<code>String</code></p>

<h3><code>Actor#email</code></h3>
<p><code>String</code></p>

<h3><code>Actor#hash</code></h3>
<p><code>String</code> - The MD5 hash of the actor’s email. Useful for displaying
<a href="http://en.gravatar.com/">Gravatar</a> avatars.</p>

<h2>Tree</h2>
<p>### <code>Tree#id</code>
<code>String</code> - SHA1</p>

<h3><code>Tree#contents(callback)</code></h3>

<ul>
  <li><code>callback</code> - Receives <code>(err, children)</code>.</li>
  <li><code>children</code> - An array of <code>Blob</code>s, <code>Tree</code>s, and <code>Submodule</code>s.</li>
</ul>

<h3><code>Tree#blobs(callback)</code></h3>

<ul>
  <li><code>callback</code> - Receives <code>(err, child_blobs)</code>.</li>
  <li><code>children</code> - <code>[Blob]</code></li>
</ul>

<h3><code>Tree#trees(callback)</code></h3>

<ul>
  <li><code>callback</code> - Receives <code>(err, child_trees)</code>.</li>
  <li><code>children</code> - <code>[Tree]</code></li>
</ul>

<h3><code>Tree#find(directory, callback)</code></h3>

<ul>
  <li><code>directory</code> - <code>String</code></li>
  <li><code>callback</code>  - Receives <code>(err, thing)</code>.</li>
</ul>

<h2>Blob</h2>
<p>### <code>Blob#id</code>
<code>String</code> - SHA1</p>

<h3><code>Blob#mode</code></h3>
<p><code>String</code></p>

<h3><code>Blob#data(callback)</code></h3>

<ul>
  <li><code>callback</code> - <code>(err, data)</code></li>
</ul>

<p>Warning: this method only returns the complete file up to 200k, which is the default
buffer size for running child_process.exec(). If the file you’re reading is bigger than
that, or if you’re not sure, you need to use dataStream()</p>

<h3><code>Blob#dataStream()</code></h3>

<ul>
  <li>returns - [dataStream, errorStream]</li>
</ul>

<p>Returns streams for you to use to get the data.</p>

<p>Usage:</p>

<pre><code>data = ""
[dataStream, _] = blob.dataStream()
dataStream.on 'data', (buf) -&gt;
  data += buf.toString()
.on 'end', -&gt;
  callback(data)
</code></pre>

<h2>Submodule</h2>
<p>### <code>Submodule#id</code>
<code>String</code></p>

<h3><code>Submodule#name</code></h3>
<p><code>String</code></p>

<h3><code>Submodule#mode</code></h3>
<p><code>String</code></p>

<h3><code>Submodule#url(callback)</code></h3>
<p>Get the url the submodule points to.</p>

<h1>License</h1>
<p>See LICENSE.</p>
